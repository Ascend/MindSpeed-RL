# 描述patch信息
patches:
  - repo: verl
    current_rev: 796871d7d092f7cbc6a64e7f4a3796f7a2217f5e # 描述当前repo使用的commit id
    versions:
    - rev: 796871d7d092f7cbc6a64e7f4a3796f7a2217f5e
      dir: 796871d7d # 对应的文件夹名称
      files:
        - name: hybrid_tp_config
          diff:
            class_changes: # 类变化
              - action: added # [added, replaced, deleted]
                name: hybrid_tp_config
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: Dict
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: DictConfig
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: HybridTPConfig
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: List
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: Optional
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: dataclass
        - name: megatron_workers
          diff:
              class_changes:
              - action: updated # [added, replaced, deleted, updated]
                name: ActorRolloutRefWorker
                changes:
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute]
                    name: compute_log_prob
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute]
                    name: update_actor
        - name: seqlen_balancing
          diff:
            changes: # [action, kind, name]
              - action: replaced # [added, replaced, deleted]
                kind: method # [class, method, attribute]
                name: rearrange_micro_batches
        - name: vllm_rollout_spmd
          diff:
              class_changes: # [action, kind, name]
              - action: updated # [added, replaced, deleted, updated]
                name: vLLMRollout
                changes: # [action, kind, name]
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [class, method, attribute]
                    name: __init__
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [class, method, attribute]
                    name: _init_dp_env
        - name: dapo_ray_trainer
          diff:
              class_changes: # [action, kind, name]
              - action: updated # [added, replaced, deleted, updated]
                name: RayDAPOTrainer
  - repo: transformers
    current_rev: 8365f70e9259c21058bf18f876006f945d2a99de
    versions:
      - rev: 8365f70e9259c21058bf18f876006f945d2a99de
        dir: 8365f70e9
        files:
          - name: modeling_qwen2
            diff:
              class_changes:
                - action: updated # [added, replaced, deleted, updated]
                  name: Qwen2RMSNorm
                  changes:
                    - action: replaced # [added, replaced, deleted]
                      kind: method # [method, attribute]
                      name: forward
                - action: updated # [added, replaced, deleted, updated]
                  name: Qwen2MLP
                  changes:
                    - action: replaced # [added, replaced, deleted]
                      kind: method # [method, attribute]
                      name: forward
              module_changes: # [action, kind, name]
                - action: added # [added, replaced, deleted]
                  kind: method # [class, method, attribute]
                  name: fused_apply_rotary_pos_emb
          - name: modeling_qwen3_moe
            diff:
              class_changes:
                - action: updated # [added, replaced, deleted, updated]
                  name: Qwen3MoeSparseMoeBlock
                  changes:
                    - action: replaced # [added, replaced, deleted]
                      kind: method # [method, attribute]
                      name: __init__
                - action: updated # [added, replaced, deleted, updated]
                  name: Qwen3MoeRMSNorm
                  changes:
                    - action: replaced # [added, replaced, deleted]
                      kind: method # [method, attribute]
                      name: forward
                - action: updated # [added, replaced, deleted, updated]
                  name: Qwen3MoeMLP
                  changes:
                    - action: replaced # [added, replaced, deleted]
                      kind: method # [method, attribute]
                      name: forward
              module_changes: # [action, kind, name]
                - action: added # [added, replaced, deleted]
                  kind: method # [class, method, attribute]
                  name: apply_rotary_pos_emb
          - name: npu_flash_attention
            diff:
              class_changes:
                - action: added # [added, replaced, deleted, updated]
                  name: IndexFirstAxis
                - action: added # [added, replaced, deleted, updated]
                  name: IndexPutFirstAxis
                - action: added # [added, replaced, deleted]
                  kind: method # [class, method, attribute]
                  name: pad_input
              module_changes: # [action, kind, name]
                - action: added # [added, replaced, deleted]
                  kind: method # [class, method, attribute]
                  name: unpad_input
                - action: added # [added, replaced, deleted]
                  kind: method # [class, method, attribute]
                  name: _prepare_from_posids