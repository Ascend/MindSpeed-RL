# 描述patch信息
patches:
  - repo: verl
    current_rev: d62da4950573d7a4b7ef2362337952e7ab59e78d # 描述当前repo使用的commit id
    versions:
    - rev: d62da4950573d7a4b7ef2362337952e7ab59e78d
      dir: d62da4950 # 对应的文件夹名称
      files:
        - name: hybrid_tp_config
          diff:
            class_changes: # 类变化
              - action: added # [added, replaced, deleted]
                name: hybrid_tp_config
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: Dict
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: DictConfig
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: HybridTPConfig
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: List
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: Optional
                  - action: added # [added, replaced, deleted]
                    kind: module_attr # [method, attribute, module_attr]
                    name: dataclass
        - name: vllm_rollout_spmd
          diff:
            class_changes: # [action, kind, name]
              - action: updated # [added, replaced, deleted, updated]
                name: vLLMRollout
                changes: # [action, kind, name]
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [class, method, attribute]
                    name: __init__
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [class, method, attribute]
                    name: _init_dp_env
        - name: config_rollout
          diff:
            class_changes: # [action, kind, name]
              - action: updated # [added, replaced, deleted, updated]
                name: RolloutConfig
                changes: # [action, kind, name]
                  - action: added # [added, replaced, deleted]
                    kind: attribute # [class, method, attribute]
                    name: dp_model_parallel_size
        - name: megatron_workers
          diff:
            class_changes: # [action, kind, name]
              - action: updated # [added, replaced, deleted, updated]
                name: MegatronWorker
                changes: # [action, kind, name]
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [class, method, attribute]
                    name: _init_hf_config_and_tf_config
  - repo: transformers
    current_rev: 8365f70e9259c21058bf18f876006f945d2a99de
    versions:
    - rev: 8365f70e9259c21058bf18f876006f945d2a99de
      dir: 8365f70e9
      files:
        - name: npu_flash_attention
          diff:
            class_changes:
              - action: updated # [added, replaced, deleted, updated]
                name: npu_flash_attention
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: parameter # [method, parameter, attribute]
                    name: sink
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [class, method, attribute]
                    name: npu_fusion_attention_v2
  - repo: vllm_ascend
    current_rev: 941d54a2ce1ce387e4bf5d80003c098ff6d44841
    versions:
    - rev: 941d54a2ce1ce387e4bf5d80003c098ff6d44841
      dir: 941d54a2c
      files:
        - name: attention_v1
          diff:
            class_changes:
              - action: updated # [added, replaced, deleted, updated]
                name: AscendAttentionBackendImpl
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: attribute # [method, parameter, attribute]
                    name: sink
        - name: fused_moe
          diff:
            class_changes:
              - action: updated # [added, replaced, deleted, updated]
                name: AscendUnquantizedFusedMoEMethod
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: attribute # [method, parameter, attribute]
                    name: sink
        - name: moe_comm_method
          diff:
            class_changes:
              - action: updated # [added, replaced, deleted, updated]
                name: MoECommMethod
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: attribute # [method, parameter, attribute]
                    name: sink
        - name: moe_mlp
          diff:
            class_changes:
              - action: updated # [added, replaced, deleted, updated]
                name: unquant_apply_mlp
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: attribute # [method, parameter, attribute]
                    name: sink
        - name: utils
          diff:
            class_changes:
              - action: added # [added, replaced, deleted, updated]
                name: use_sink_attention
                changes:
                  - action: added # [added, replaced, deleted]
                    kind: method # [method, parameter, attribute]
                    name: sink
  - repo: mbridge
    current_rev: da21f041311e73c99c337c2411223039f20eefb6
    versions:
    - rev: da21f041311e73c99c337c2411223039f20eefb6
      dir: da21f0413
      files:
        - name: dequant_fp8_safetensor_io
          diff:
            class_changes:
              - action: replaced # [added, replaced, deleted]
                name: DequantFP8SafeTensorIO
                changes:
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute, module_attr]
                    name: load_some_hf_weight
        - name: device
          diff:
            class_changes:
              - action: added # [added, replaced, deleted]
                name: device
                changes:
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute, module_attr]
                    name: is_torch_npu_available
  - repo: mindspeed
    current_rev: a654440c14159a68c8a7f1e1665a89bdec8e74f0
    versions:
    - rev: a654440c14159a68c8a7f1e1665a89bdec8e74f0
      dir: a654440c14
      files:
        - name: adaptor
          diff:
            class_changes:
              - action: replaced # [added, replaced, deleted]
                name: adaptor
                changes:
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute, module_attr]
                    name: dot_product_attention_forward_impl
      files:
        - name: grouped_linear
          diff:
            class_changes:
              - action: replaced # [added, replaced, deleted]
                name: MindSpeedTEGroupedLinear
                changes:
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute, module_attr]
                    name: forward
  - repo: megatron-core
    current_rev: a845aa7e12b3a117e24c2352b9e3e60bad2e3a17
    versions:
    - rev: a845aa7e12b3a117e24c2352b9e3e60bad2e3a17
      dir: a845aa7e12
      files:
        - name: dot_product_attention
          diff:
            class_changes:
              - action: replaced # [added, replaced, deleted]
                name: DotProductAttention
                changes:
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute, module_attr]
                    name: __init__
        - name: multi_token_prediction
          diff:
            class_changes:
              - action: replaced # [added, replaced, deleted]
                name: MultiTokenPredictionBlock
                changes:
                  - action: replaced # [added, replaced, deleted]
                    kind: method # [method, attribute, module_attr]
                    name: forward
                  
